
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Request.el – Easy HTTP request for Emacs Lisp &mdash; Request.el 0.2.0 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Request.el 0.2.0 documentation" href="#" />
    <link rel="next" title="Request.el manual" href="manual.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="manual.html" title="Request.el manual"
             accesskey="N">next</a> |</li>
        <li><a href="#">Request.el 0.2.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <div class="section" id="request-el-easy-http-request-for-emacs-lisp">
<h1>Request.el &#8211; Easy HTTP request for Emacs Lisp<a class="headerlink" href="#request-el-easy-http-request-for-emacs-lisp" title="Permalink to this headline">¶</a></h1>
<div class="sidebar">
<p class="first sidebar-title">Links</p>
<ul class="last simple">
<li><a class="reference external" href="http://tkf.github.com/emacs-request/">Documentation</a> (at GitHub Pages)<ul>
<li><a class="reference external" href="http://tkf.github.com/emacs-request/manual.html">Manual</a></li>
</ul>
</li>
<li><a class="reference external" href="https://github.com/tkf/emacs-request">Repository</a> (at GitHub)</li>
<li><a class="reference external" href="https://github.com/tkf/emacs-request/issues">Issue tracker</a> (at GitHub)</li>
<li><a class="reference external" href="https://travis-ci.org/#!/tkf/emacs-request">Travis CI</a> <a class="reference external" href="http://travis-ci.org/tkf/emacs-request"><img alt="Build Status" src="https://secure.travis-ci.org/tkf/emacs-request.png?branch=master" /></a></li>
</ul>
</div>
<div class="section" id="what-is-it">
<h2>What is it?<a class="headerlink" href="#what-is-it" title="Permalink to this headline">¶</a></h2>
<p>Request.el is a HTTP request library with multiple backends.  It
supports url.el which is shipped with Emacs and curl command line
program.  User can use curl when s/he has it, as curl is more reliable
than url.el.  Library author can use request.el to avoid imposing
external dependencies such as curl to users while giving richer
experience for users who have curl.</p>
<p>As request.el is implemented in extensible manner, it is possible to
implement other backend such as wget.  Also, if future version of
Emacs support linking with libcurl, it is possible to implement a
backend using it.  Libraries using request.el automatically can
use these backend without modifying their code.</p>
<p>Request.el also patches url.el dynamically, to fix bugs in url.el.
See <a class="reference internal" href="#monkey-patches-for-url-el">monkey patches for url.el</a> for the bugs fixed by request.el.</p>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>GET:</p>
<div class="highlight-cl"><div class="highlight"><pre><span class="p">(</span><span class="nv">request</span>
 <span class="s">&quot;http://httpbin.org/get&quot;</span>
 <span class="ss">:params</span> <span class="o">&#39;</span><span class="p">((</span><span class="s">&quot;key&quot;</span> <span class="o">.</span> <span class="s">&quot;value&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;key2&quot;</span> <span class="o">.</span> <span class="s">&quot;value2&quot;</span><span class="p">))</span>
 <span class="ss">:parser</span> <span class="ss">&#39;json-read</span>
 <span class="ss">:success</span> <span class="p">(</span><span class="nv">cl-function</span>
 <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="k">&amp;key</span> <span class="nv">data</span> <span class="k">&amp;allow-other-keys</span><span class="p">)</span>
             <span class="p">(</span><span class="nv">message</span> <span class="s">&quot;I sent: %S&quot;</span> <span class="p">(</span><span class="nv">assoc-default</span> <span class="ss">&#39;args</span> <span class="nv">data</span><span class="p">)))))</span>
</pre></div>
</div>
<p>POST:</p>
<div class="highlight-cl"><div class="highlight"><pre><span class="p">(</span><span class="nv">request</span>
 <span class="s">&quot;http://httpbin.org/post&quot;</span>
 <span class="ss">:type</span> <span class="s">&quot;POST&quot;</span>
 <span class="ss">:data</span> <span class="o">&#39;</span><span class="p">((</span><span class="s">&quot;key&quot;</span> <span class="o">.</span> <span class="s">&quot;value&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;key2&quot;</span> <span class="o">.</span> <span class="s">&quot;value2&quot;</span><span class="p">))</span>
 <span class="c1">;; :data &quot;key=value&amp;key2=value2&quot;  ; this is equivalent</span>
 <span class="ss">:parser</span> <span class="ss">&#39;json-read</span>
 <span class="ss">:success</span> <span class="p">(</span><span class="nv">cl-function</span>
 <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="k">&amp;key</span> <span class="nv">data</span> <span class="k">&amp;allow-other-keys</span><span class="p">)</span>
             <span class="p">(</span><span class="nv">message</span> <span class="s">&quot;I sent: %S&quot;</span> <span class="p">(</span><span class="nv">assoc-default</span> <span class="ss">&#39;form</span> <span class="nv">data</span><span class="p">)))))</span>
</pre></div>
</div>
<p>POST file (<strong>WARNING</strong>: it will send the contents of the current buffer!):</p>
<div class="highlight-cl"><div class="highlight"><pre><span class="p">(</span><span class="nv">request</span>
 <span class="s">&quot;http://httpbin.org/post&quot;</span>
 <span class="ss">:type</span> <span class="s">&quot;POST&quot;</span>
 <span class="ss">:files</span> <span class="o">`</span><span class="p">((</span><span class="s">&quot;current buffer&quot;</span> <span class="o">.</span> <span class="o">,</span><span class="p">(</span><span class="nv">current-buffer</span><span class="p">))</span>
          <span class="p">(</span><span class="s">&quot;data&quot;</span> <span class="o">.</span> <span class="p">(</span><span class="s">&quot;data.csv&quot;</span> <span class="ss">:data</span> <span class="s">&quot;1,2,3\n4,5,6\n&quot;</span><span class="p">)))</span>
 <span class="ss">:parser</span> <span class="ss">&#39;json-read</span>
 <span class="ss">:success</span> <span class="p">(</span><span class="nv">cl-function</span>
 <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="k">&amp;key</span> <span class="nv">data</span> <span class="k">&amp;allow-other-keys</span><span class="p">)</span>
             <span class="p">(</span><span class="nv">message</span> <span class="s">&quot;I sent: %S&quot;</span> <span class="p">(</span><span class="nv">assoc-default</span> <span class="ss">&#39;files</span> <span class="nv">data</span><span class="p">)))))</span>
</pre></div>
</div>
<p>Rich callback dispatch (like <cite>jQuery.ajax</cite>):</p>
<div class="highlight-cl"><div class="highlight"><pre><span class="p">(</span><span class="nv">request</span>
 <span class="s">&quot;http://httpbin.org/status/418&quot;</span>     <span class="c1">; try other codes, for example:</span>
 <span class="c1">;; &quot;http://httpbin.org/status/200&quot;  ; success callback will be called.</span>
 <span class="c1">;; &quot;http://httpbin.org/status/400&quot;  ; you will see &quot;Got 400.&quot;</span>
 <span class="ss">:parser</span> <span class="ss">&#39;buffer-string</span>
 <span class="ss">:success</span>
 <span class="p">(</span><span class="nv">cl-function</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="k">&amp;key</span> <span class="nv">data</span> <span class="k">&amp;allow-other-keys</span><span class="p">)</span>
 <span class="p">(</span><span class="nb">when</span> <span class="nv">data</span>
                <span class="p">(</span><span class="nv">with-current-buffer</span> <span class="p">(</span><span class="nv">get-buffer-create</span> <span class="s">&quot;*request demo*&quot;</span><span class="p">)</span>
                  <span class="p">(</span><span class="nv">erase-buffer</span><span class="p">)</span>
                  <span class="p">(</span><span class="nv">insert</span> <span class="nv">data</span><span class="p">)</span>
                  <span class="p">(</span><span class="nv">pop-to-buffer</span> <span class="p">(</span><span class="nv">current-buffer</span><span class="p">))))))</span>
 <span class="ss">:error</span>
 <span class="p">(</span><span class="nv">cl-function</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="k">&amp;key</span> <span class="nv">error-thrown</span> <span class="nv">&amp;allow-other-keys&amp;rest</span> <span class="nv">_</span><span class="p">)</span>
 <span class="p">(</span><span class="nv">message</span> <span class="s">&quot;Got error: %S&quot;</span> <span class="nv">error-thrown</span><span class="p">)))</span>
 <span class="ss">:complete</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="k">&amp;rest</span> <span class="nv">_</span><span class="p">)</span> <span class="p">(</span><span class="nv">message</span> <span class="s">&quot;Finished!&quot;</span><span class="p">))</span>
 <span class="ss">:status-code</span> <span class="o">&#39;</span><span class="p">((</span><span class="mi">400</span> <span class="o">.</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="k">&amp;rest</span> <span class="nv">_</span><span class="p">)</span> <span class="p">(</span><span class="nv">message</span> <span class="s">&quot;Got 400.&quot;</span><span class="p">)))</span>
                <span class="p">(</span><span class="mi">418</span> <span class="o">.</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="k">&amp;rest</span> <span class="nv">_</span><span class="p">)</span> <span class="p">(</span><span class="nv">message</span> <span class="s">&quot;Got 418.&quot;</span><span class="p">)))))</span>
</pre></div>
</div>
<p>Flexible PARSER option:</p>
<div class="highlight-cl"><div class="highlight"><pre><span class="p">(</span><span class="nv">request</span>
 <span class="s">&quot;https://github.com/tkf/emacs-request/commits/master.atom&quot;</span>
 <span class="c1">;; Parse XML in response body:</span>
 <span class="ss">:parser</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">()</span> <span class="p">(</span><span class="nv">libxml-parse-xml-region</span> <span class="p">(</span><span class="nv">point</span><span class="p">)</span> <span class="p">(</span><span class="nv">point-max</span><span class="p">)))</span>
 <span class="ss">:success</span> <span class="p">(</span><span class="nv">cl-function</span>
 <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="k">&amp;key</span> <span class="nv">data</span> <span class="k">&amp;allow-other-keys</span><span class="p">)</span>
             <span class="c1">;; Just don&#39;t look at this function....</span>
             <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nb">get</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nv">node</span> <span class="k">&amp;rest</span> <span class="nv">names</span><span class="p">)</span>
                          <span class="p">(</span><span class="k">if</span> <span class="nv">names</span>
                              <span class="p">(</span><span class="nb">apply</span> <span class="nb">get</span>
                                     <span class="p">(</span><span class="nb">first</span> <span class="p">(</span><span class="nv">xml-get-children</span>
                                             <span class="nv">node</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">names</span><span class="p">)))</span>
                                     <span class="p">(</span><span class="nb">cdr</span> <span class="nv">names</span><span class="p">))</span>
                            <span class="p">(</span><span class="nb">first</span> <span class="p">(</span><span class="nv">xml-node-children</span> <span class="nv">node</span><span class="p">))))))</span>
               <span class="p">(</span><span class="nv">message</span> <span class="s">&quot;Latest commit: %s (by %s)&quot;</span>
                        <span class="p">(</span><span class="nb">funcall</span> <span class="nb">get</span> <span class="nv">data</span> <span class="ss">&#39;entry</span> <span class="ss">&#39;title</span><span class="p">)</span>
                        <span class="p">(</span><span class="nb">funcall</span> <span class="nb">get</span> <span class="nv">data</span> <span class="ss">&#39;entry</span> <span class="ss">&#39;author</span> <span class="ss">&#39;name</span><span class="p">))))))</span>
</pre></div>
</div>
<p>PUT JSON data:</p>
<div class="highlight-cl"><div class="highlight"><pre><span class="p">(</span><span class="nv">request</span>
 <span class="s">&quot;http://httpbin.org/put&quot;</span>
 <span class="ss">:type</span> <span class="s">&quot;PUT&quot;</span>
 <span class="ss">:data</span> <span class="p">(</span><span class="nv">json-encode</span> <span class="o">&#39;</span><span class="p">((</span><span class="s">&quot;key&quot;</span> <span class="o">.</span> <span class="s">&quot;value&quot;</span><span class="p">)</span> <span class="p">(</span><span class="s">&quot;key2&quot;</span> <span class="o">.</span> <span class="s">&quot;value2&quot;</span><span class="p">)))</span>
 <span class="ss">:headers</span> <span class="o">&#39;</span><span class="p">((</span><span class="s">&quot;Content-Type&quot;</span> <span class="o">.</span> <span class="s">&quot;application/json&quot;</span><span class="p">))</span>
 <span class="ss">:parser</span> <span class="ss">&#39;json-read</span>
 <span class="ss">:success</span> <span class="p">(</span><span class="nv">cl-function</span>
 <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="k">&amp;key</span> <span class="nv">data</span> <span class="k">&amp;allow-other-keys</span><span class="p">)</span>
             <span class="p">(</span><span class="nv">message</span> <span class="s">&quot;I sent: %S&quot;</span> <span class="p">(</span><span class="nv">assoc-default</span> <span class="ss">&#39;json</span> <span class="nv">data</span><span class="p">)))))</span>
</pre></div>
</div>
</div>
<div class="section" id="compatibility-backends">
<h2>Compatibility / backends<a class="headerlink" href="#compatibility-backends" title="Permalink to this headline">¶</a></h2>
<p>Supported Emacs versions:</p>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="38%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Emacs version</th>
<th class="head">Does request.el work?</th>
<th class="head">Tested on Travis CI
<a class="reference external" href="http://travis-ci.org/tkf/emacs-request"><img alt="Build Status" src="https://secure.travis-ci.org/tkf/emacs-request.png?branch=master" /></a></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GNU Emacs 24.3-devel</td>
<td>yes (as of this writing)</td>
<td>yes</td>
</tr>
<tr class="row-odd"><td>GNU Emacs 24.2</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr class="row-even"><td>GNU Emacs 24.1</td>
<td>yes</td>
<td>no</td>
</tr>
<tr class="row-odd"><td>GNU Emacs 23.4</td>
<td>yes</td>
<td>no</td>
</tr>
<tr class="row-even"><td>GNU Emacs 23.3</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr class="row-odd"><td>GNU Emacs 23.1</td>
<td>yes (as of this writing)</td>
<td>no</td>
</tr>
<tr class="row-even"><td>GNU Emacs &lt; 23</td>
<td>?</td>
<td>no</td>
</tr>
</tbody>
</table>
<p>Supported backends:</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="28%" />
<col width="23%" />
<col width="35%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Backends</th>
<th class="head">Remarks</th>
<th class="head">Multipart Form</th>
<th class="head">Automatic Decompression</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>url.el</td>
<td>Included in Emacs</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>curl</td>
<td>Reliable</td>
<td>✔</td>
<td>✔</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="monkey-patches-for-url-el">
<h2>Monkey patches for url.el<a class="headerlink" href="#monkey-patches-for-url-el" title="Permalink to this headline">¶</a></h2>
<p>Patches for following bugs are applied when request.el is loaded.
If the patch is not required for the Emacs version you are using, it
will not be applied.</p>
<ul>
<li><p class="first"><a class="reference external" href="http://debbugs.gnu.org/cgi/bugreport.cgi?bug=12374">#12374 - 24.1.50;
Incorrect redirect in url-retrieve when URL contains port number -
GNU bug report logs</a></p>
<p>(patch: <a class="reference external" href="http://article.gmane.org/gmane.emacs.devel/155698">PATCH Fix bug 12374 treat port number when expanding URL</a>)</p>
</li>
<li><p class="first"><a class="reference external" href="http://debbugs.gnu.org/cgi/bugreport.cgi?bug=11469">#11469 - 24.1.50; url-retrieve with PUT method fails every two
times - GNU bug report logs</a></p>
<p>(patch: <a class="reference external" href="http://article.gmane.org/gmane.emacs.devel/155697">PATCH Fix bug 11469 propagate url request vars properly</a>)</p>
</li>
</ul>
</div>
<div class="section" id="related-projects">
<h2>Related projects<a class="headerlink" href="#related-projects" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt><a class="reference external" href="https://github.com/leathekd/grapnel">leathekd/grapnel · GitHub</a>:</dt>
<dd>&#8220;HTTP request for Emacs lib built on curl with flexible callback dispatch&#8221;</dd>
<dt><a class="reference external" href="https://github.com/cinsk/emacs-curl">cinsk/emacs-curl · GitHub</a>:</dt>
<dd>&#8220;CURL wrapper for Emacs&#8221;</dd>
<dt><a class="reference external" href="http://code.google.com/p/furl-el/">furl-el - Google Project Hosting</a>:</dt>
<dd>&#8220;A wrapper for url.el that adds a nicer API and the ability to make
multipart POST requests.&#8221;</dd>
</dl>
</div>
<div class="section" id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h2>
<p>Request.el is free software under GPL v3.
See COPYING file for details.</p>
</div>
<div class="section" id="indices-and-tables">
<h2>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="manual.html">Request.el manual</a><ul>
<li class="toctree-l2"><a class="reference internal" href="manual.html#api">API</a></li>
<li class="toctree-l2"><a class="reference internal" href="manual.html#configuration">Configuration</a></li>
</ul>
</li>
</ul>
</div>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><em>Index</em></a></li>
<li><a class="reference internal" href="search.html"><em>Search Page</em></a></li>
</ul>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="manual.html" title="Request.el manual"
             >next</a> |</li>
        <li><a href="#">Request.el 0.2.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Takafumi Arakaki.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>